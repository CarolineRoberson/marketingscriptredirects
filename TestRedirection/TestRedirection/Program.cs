using System.Diagnostics;
using System.Net;
using System.Xml.Serialization;
using AsciiTableFormatter;
using HtmlAgilityPack;

namespace TestRedirection;

public class Program
{
    public static async Task Main()
    {
        var querystring = "?requested_by=Jeff%20Adkisson&company=Jeff%27s%20Test%20Company&email=Jeff%40HighMatch.com";
        var serializer = new XmlSerializer(typeof(RewriteMap));
        RewriteMap? map;
        var results = new List<Redirection>();

        using (var reader = new StringReader(GetXml()))
        {
            map = (RewriteMap)serializer.Deserialize(reader)!;
            Debug.Assert(map.Add != null, "map.Add != null");
            var list = map.Add.OrderBy((Func<Add, string>)(l => l.Key!)).ToList();
            foreach (var target in list.Take(5))
            {
                Task.Delay(100).Wait();

                //without slash
                var toUrl = target.Key!.Length > 1 && target.Key.EndsWith("/")
                    ? target.Key.Substring(target.Key.Length - 2)
                    : target.Key;
                results.Add(await TestPath(toUrl, target.Value!));

                //without slash plus querystring
                toUrl = $"{toUrl}{querystring}";
                results.Add(await TestPath(toUrl, target.Value));

                //with slash
                toUrl = target.Key.EndsWith("/") ? target.Key : $"{target.Key}/";
                results.Add(await TestPath(toUrl, target.Value));

                //with slash plus querystring
                toUrl = target.Key.EndsWith("/") ? target.Key : $"{target.Key}/";
                toUrl = $"{toUrl}{querystring}";
                results.Add(await TestPath(toUrl, target.Value));
            }
        }

        var output = Formatter.Format(results);
        Console.WriteLine(output);
        Console.WriteLine("Press a key to exit");
        Console.ReadKey();
    }

    private static string GetXml() =>
        "<rewriteMap name=\"HighMatchGoLiveRedirects20211216\" defaultValue=\"\">\r\n<add key=\"/\" value=\"https://www.highmatch.com\" />\r\n\t\t\t<add key=\"/support/request-a-job\" value=\"https://www.highmatch.com/job-request-form\" />\r\n\t\t\t<add key=\"/features/hiring-profiles\" value=\"https://www.highmatch.com/job-profile\" />\r\n\t\t\t<add key=\"/features/benchmark-studies\" value=\"https://www.highmatch.com/talent-insights/talent-consulting/benchmark-study\" />\r\n\t\t\t<add key=\"/blog\" value=\"https://blog.highmatch.com/highmatch-blog\" />\r\n\t\t\t<add key=\"/docuthanks\" value=\"https://www.highmatch.com/resources/docusign-thanks\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing\" value=\"https://www.highmatch.com/talent-insights/aptitude-test\" />\r\n\t\t\t<add key=\"/features/assessment\" value=\"https://www.highmatch.com/talent-insights/personality-assessment\" />\r\n\t\t\t<add key=\"/support\" value=\"https://forms.highmatch.com/hm-support-request\" />\r\n\t\t\t<add key=\"/solutions/skills-testing\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/personality-testing\" value=\"https://www.highmatch.com/talent-insights/personality-assessment\" />\r\n\t\t\t<add key=\"/pricing\" value=\"https://www.highmatch.com\" />\r\n\t\t\t<add key=\"/solutions\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test\" />\r\n\t\t\t<add key=\"/features\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-tool\" />\r\n\t\t\t<add key=\"/features/reports\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-tool/job-candidate-interview-report\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing/spatial-reasoning\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/spatial-reasoning\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/teamwork\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/teamwork-skills-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/work-skills\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/conscientiousness\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/conscientiousness-test\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/cash-handling\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/cash-handling-assessment-test\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/work-ethic\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/work-ethic-skills\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/adaptability\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/adaptability-skills\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing/logical-reasoning\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/logical-reasoning-test\" />\r\n\t\t\t<add key=\"/features/applicant-tracking-integrations\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-tool/assessment-workflow\" />\r\n\t\t\t<add key=\"/resources/guides/the-gen-z-revolution\" value=\"https://forms.highmatch.com/hm-the-gen-z-revolution\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing/vocabulary\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/vocabulary-test-for-employment\" />\r\n\t\t\t<add key=\"/resources/guides/top-talent-acquisition-challenges\" value=\"https://forms.highmatch.com/hm-ta-hr-challenges-report-2019\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/extraversion-and-introversion\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/introvert-extrovert-test\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/soft-skills\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/soft-skills-assessment\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing/problem-solving\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/problem-solving-test\" />\r\n\t\t\t<add key=\"/customer-survey\" value=\"https://www.highmatch.com\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-job-type\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/skills-assessment-test\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/culture-fit\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/culture-fit-assessment-test\" />\r\n\t\t\t<add key=\"/solutions/personality-testing/emotional-intelligence\" value=\"https://www.highmatch.com/talent-insights/personality-assessment/emotional-intelligence-test\" />\r\n\t\t\t<add key=\"/resources/guides/pre-employment-testing-guide\" value=\"https://forms.highmatch.com/hm-ultimate-preemployment-testing-buyers-guide\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing/analytical-skills\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/analytical-skills-test\" />\r\n\t\t\t<add key=\"/solutions/aptitude-testing/critical-thinking\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/critical-thinking-assessment-test\" />\r\n\t\t\t<add key=\"/privacy\" value=\"https://www.highmatch.com/pre-employment-assessment/privacy-policy\" />\r\n\t\t\t<add key=\"/terms-of-service\" value=\"https://www.highmatch.com/pre-employment-assessment/terms-of-service\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/microsoft-excel\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/microsoft-excel-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/microsoft-word\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/microsoft-word-assessment-test\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-coldfusion\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/net-programming-mvc-framework-asp-5\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/active-directory-domain-services\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/advanced-accounting\" value=\"https://highmatch.com/talent-insights/skill-assessmentadvanced-accounting-test/\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-illustrator\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/net-programming-asp\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/accpac-pro-series\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-pagemaker-7\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-photoshop\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adabas-programming\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/aion-programming\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/active-server-pages\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/net-programming-c\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/accounts-receivable\" value=\"https://highmatch.com/talent-insights/skill-assessmentaccounts-receivable-assessment-test\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/actionscript-30\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-dreamweaver\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/accounting-terminology\" value=\"https://highmatch.com/talent-insights/skill-assessmentaccounting-terminology-basic-test\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adabas-natural\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-flex-3\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-acrobat\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/abap4-for-sap\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/agile-software-development\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adabas-dba\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/net-framework\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-flash\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adobe-indesign\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/html\" value=\"https://highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/accounts-payable\" value=\"https://highmatch.com/talent-insights/skill-assessmentaccounts-payable-assessment/\" />\r\n\t\t\t<add key=\"/features/reports/sample-interview-guide\" value=\"https://knowledge.highmatch.com/hubfs/PDFs/Sample%20Reports%20and%20Guides/HM-Sample%20Interview%20Guide-Elizabeth%20Thompson.pdf\" />\r\n\t\t\t<add key=\"/features/reports/sample-job-fit-report\" value=\"https://knowledge.highmatch.com/hubfs/PDFs/Sample%20Reports%20and%20Guides/HM-Sample%20Job%20Fit%20Report-Elizabeth%20Thompson.pdf\" />\r\n\t\t\t<add key=\"/features/reports/sample-participant-report\" value=\"https://knowledge.highmatch.com/hubfs/PDFs/Sample%20Reports%20and%20Guides/HM-Sample%20Participant%20Report-Elizabeth%20Thompson.pdf\" />\r\n\t\t\t<add key=\"/features/reports/sample-spotlight-report\" value=\"https://knowledge.highmatch.com/hubfs/PDFs/Sample%20Reports%20and%20Guides/HM-Sample%20Spotlight%20Report-Elizabeth%20Thompson.pdf\" />\r\n\t\t\t<add key=\"/request-a-trial\" value=\"https://highmatch.com/talent-acquisition-strategies/\" />\r\n\t\t\t<add key=\"/resources/guides\" value=\"https://highmatch.com/guides-and-reports/\" />\r\n\t\t\t<add key=\"/resources\" value=\"https://highmatch.com/guides-and-reports/\" />\r\n\t\t\t<add key=\"/about/careers\" value=\"https://highmatch.com/pre-employment-assessment/careers/\" />\r\n\t\t\t<add key=\"/resources/how-to/connect-to-other-tools/using-cats\" value=\"https://blog.highmatch.com/knowledge-base/using-cats\" />\r\n\t\t\t<add key=\"/resources/how-to\" value=\"https://blog.highmatch.com/knowledge-base\" />\r\n\t\t\t<add key=\"/resources/how-to/learn-the-basics/personalizing-your-assessment\" value=\"https://blog.highmatch.com/knowledge-base/personalizing-your-assessments\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/adding-new-departments\" value=\"https://blog.highmatch.com/knowledge-base/adding-new-departments\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/inviting-people-to-assessments\" value=\"https://blog.highmatch.com/knowledge-base/inviting-people-to-assessments\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/understanding-the-demographic-survey\" value=\"https://blog.highmatch.com/knowledge-base/understanding-the-demographic-survey\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/reviewing-history-logs\" value=\"https://blog.highmatch.com/knowledge-base/reviewing-history-logs\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/updating-participant-information\" value=\"https://blog.highmatch.com/knowledge-base/updating-participant-information\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/updating-your-information\" value=\"https://blog.highmatch.com/knowledge-base/updating-your-information\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/creating-recruit-links\" value=\"https://blog.highmatch.com/knowledge-base/creating-recruit-links\" />\r\n\t\t\t<add key=\"/resources/how-to/using-berke-assessment/adding-new-users\" value=\"https://blog.highmatch.com/knowledge-base/adding-new-users\" />\r\n\t\t\t<add key=\"/how-to/connect-to-other-tools/email-connector\" value=\"https://blog.highmatch.com/knowledge-base\" />\r\n\t\t\t<add key=\"/about\" value=\"https://www.highmatch.com/pre-employment-assessment/about-review\" />\r\n\t\t\t<add key=\"/construction-superintendent\" value=\"https://www.highmatch.com/solutions/construction-superintendent-skills\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/advanced-spelling\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/adp-payroll\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/typing\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/basic-typing-skills-test\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/age-appropriate-testing\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/shop-math\" value=\"https://www.highmatch.com/talent-insights/skill-assessment/shop-math-test\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/weights-and-measures\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-name/customer-service-mindset-survey\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/login\" value=\"https://www.highmatch.com/login\" />\r\n\t\t\t<add key=\"/features/assessment/free-personality-test\" value=\"https://forms.highmatch.com/hm-free-personality-test\" />\r\n\t\t\t<add key=\"/product\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test\" />\r\n\t\t\t<add key=\"/hiring-product\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test\" />\r\n\t\t\t<add key=\"/feature-product\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test\" />\r\n\t\t\t<add key=\"/cognitive-ability-product\" value=\"https://www.highmatch.com/talent-insights/aptitude-test\" />\r\n\t\t\t<add key=\"/aptitude-product\" value=\"https://www.highmatch.com/talent-insights/aptitude-test\" />\r\n\t\t\t<add key=\"/personality-product\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/skills-product\" value=\"https://www.highmatch.com/talent-insights/skill-assessment\" />\r\n\t\t\t<add key=\"/request-a-demo\" value=\"https://forms.highmatch.com/hm-demo-form\" />\r\n\t\t\t\r\n\t\t\t<add key=\"/about/contact-us\" value=\"https://forms.highmatch.com/hm-contact-sales\" />\r\n\t\t\t<add key=\"/default.aspx\" value=\"https://www.highmatch.com\" />\r\n\t\t\t<add key=\"/product-abm\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-tool/pre-employment-assessment\" />\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t<add key=\"/solutions/aptitude-testing/cognitive-ability\" value=\"https://www.highmatch.com/talent-insights/aptitude-test/cognitive-ability-test\" />\r\n\t\t\t<add key=\"/elite\" value=\"https://forms.highmatch.com/hm-elite-partnership\" />\r\n\t\t\t<add key=\"/personality-test\" value=\"https://www.highmatch.com/talent-insights/personality-assessment\" />\t\r\n\t\t\t\r\n\t\t\t<add key=\"/pre-employment-test\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test/\" />\r\n\t\t\t<add key=\"/features-test\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test/\" />\r\n\t\t\t<add key=\"/resources/guides/customer-service-hiring\" value=\"https://www.highmatch.com/solutions/customer-service-assessment-test/\" />\r\n\t\t\t<add key=\"/resources/how-to/learn-the-basics/understanding-the-assessments-tab\" value=\"https://blog.highmatch.com/knowledge-base/getting-started-with-highmatch-2\" />\r\n\t\t\t\r\n\t\t\t<add key=\"/blog-articles/10-depressing-stats-about-workplace-discrimination\" value=\"https://www.highmatch.com/blog/10-depressing-stats-about-workplace-discrimination/\" />\r\n\t\t\t<add key=\"/blog-articles/recruiting-trends-for-2019\" value=\"https://www.highmatch.com/blog/2022-hiring-trends/\" />\r\n\t\t\t<add key=\"/blog-articles/3-assessment-options-for-volume-hiring-how-to-scale-your-virtual-hiring-process-with-confidence\" value=\"https://www.highmatch.com/blog/scale-your-virtual-hiring-process-3-assessment-options-for-volume-hiring/\" />\r\n\t\t\t<add key=\"/blog-articles/3-types-of-people-to-help-you-interview\" value=\"https://www.highmatch.com/blog/3-types-of-people-to-help-you-interview/\" />\r\n\t\t\t<add key=\"/blog-articles/3-ways-hr-technology-fosters-stronger-relationships\" value=\"https://www.highmatch.com/blog/3-ways-hr-technology-fosters-stronger-relationships/\" />\r\n\t\t\t<add key=\"/blog-articles/4-steps-to-achieve-workforce-agility\" value=\"https://www.highmatch.com/blog/4-steps-to-achieve-an-agile-workforce/\" />\r\n\t\t\t<add key=\"/blog-articles/5-challenges-to-hiring-success-today\" value=\"https://www.highmatch.com/blog/5-challenges-in-hiring-employees-today/\" />\r\n\t\t\t<add key=\"/blog-articles/5-things-you-don-t-know-about-berke\" value=\"https://www.highmatch.com/blog/5-things-you-dont-know-about-highmatch/\" />\r\n\t\t\t<add key=\"/blog-articles/are-you-confusing-sociability-and-social-skills\" value=\"https://www.highmatch.com/blog/assessing-social-skills-are-you-mixing-up-sociability/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-hire-for-business-growth\" value=\"https://www.highmatch.com/blog/business-growth-strategy-hiring-for-success/\" />\r\n\t\t\t<add key=\"/blog-articles/your-managers-are-killing-engagement\" value=\"https://www.highmatch.com/blog/candidate-engagement-your-managers-are-killing-it/\" />\r\n\t\t\t<add key=\"/blog-articles/di-mistakes-are-fueled-by-dirty-data\" value=\"https://www.highmatch.com/blog/di-mistakes-are-fueled-by-dirty-human-capital-data/\" />\r\n\t\t\t<add key=\"/blog-articles/three-essential-facets-of-job-performance\" value=\"https://www.highmatch.com/blog/defining-job-performance-three-essential-facets/\" />\r\n\t\t\t<add key=\"/blog-articles/let-the-candidate-experience-drive-job-postings\" value=\"https://www.highmatch.com/blog/drive-job-postings-with-candidate-experience-best-practices/\" />\r\n\t\t\t<add key=\"/blog-articles/more-remote-work-stories-from-the-quarantine-6-leaders-get-creative-to-support-employees-customers-and-their-communities\" value=\"https://www.highmatch.com/blog/employee-engagement-with-remote-workers-examples/\" />\r\n\t\t\t<add key=\"/blog-articles/employer-branding-strategies\" value=\"https://www.highmatch.com/blog/employer-branding-strategies-delivering-an-innovative-brand/\" />\r\n\t\t\t<add key=\"/blog-articles/ensure-success-with-secondary-interviews\" value=\"https://www.highmatch.com/blog/ensure-success-with-secondary-interviews/\" />\r\n\t\t\t<add key=\"/5-reasons-to-look-beyond-the-resume\" value=\"https://www.highmatch.com/blog/fact-or-fiction-looking-beyond-the-resume/\" />\r\n\t\t\t<add key=\"/blog-articles/finding-leaders-for-the-future\" value=\"https://www.highmatch.com/blog/finding-leaders-for-the-future-success-of-your-organization/\" />\r\n\t\t\t<add key=\"/blog-articles/gender-discrimination-how-recruiters-can-help\" value=\"https://www.highmatch.com/blog/gender-bias-in-the-workplace-it-starts-in-recruiting/\" />\r\n\t\t\t<add key=\"/blog-articles/frequently-asked-questions-for-highmatch\" value=\"https://www.highmatch.com/blog/highmatch-faq/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-successfully-apply-fit-to-your-hiring\" value=\"https://www.highmatch.com/blog/hiring-for-fit-how-to-apply-it-to-your-process/\" />\r\n\t\t\t<add key=\"/blog-articles/hiring-for-potential-what-it-means-and-how-to-do-it\" value=\"https://www.highmatch.com/blog/hiring-for-potential-what-it-means-and-how-to-do-it/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-identify-top-sales-professionals\" value=\"https://www.highmatch.com/blog/hiring-sales-reps-how-to-identify-top-talent/\" />\r\n\t\t\t<add key=\"/blog-articles/the-future-of-resumes\" value=\"https://www.highmatch.com/blog/hiring-strategies-the-future-of-resumes/\" />\r\n\t\t\t<add key=\"/blog-articles/7-tips-for-hiring-top-tech-talent\" value=\"https://www.highmatch.com/blog/hiring-top-tech-talent---7-tips/\" />\r\n\t\t\t<add key=\"/blog-articles/how-bad-interviews-derail-good-recruiting\" value=\"https://www.highmatch.com/blog/how-bad-interviews-derail-good-candidate-recruitment/\" />\r\n\t\t\t<add key=\"/blog-articles/how-candidate-personas-can-improve-the-recruiting-process\" value=\"https://www.highmatch.com/blog/how-candidate-personas-can-improve-the-recruiting-process/\" />\r\n\t\t\t<add key=\"/blog-articles/how-job-profiles-create-consensus-in-hiring-teams\" value=\"https://www.highmatch.com/blog/how-job-profiles-create-consensus-in-hiring-teams/\" />\r\n\t\t\t<add key=\"/blog-articles/employee-development-how-pre-hire-assessments-can-help\" value=\"https://www.highmatch.com/blog/how-pre-hire-assessment-tools-support-employee-development/\" />\r\n\t\t\t<add key=\"/blog-articles/the-secret-enemy-of-your-diversity-hiring-efforts-and-how-to-fight-it\" value=\"https://www.highmatch.com/blog/unconscious-bias-in-recruitment-enemy-of-diversity-hiring/\" />\r\n\t\t\t<add key=\"/blog-articles/design-thinkers-are-better-recruiters\" value=\"https://www.highmatch.com/blog/how-to-be-a-better-recruiter-with-design-thinking/\" />\r\n\t\t\t<add key=\"/blog-articles/5-tips-to-win-over-hiring-managers\" value=\"https://www.highmatch.com/blog/how-to-become-a-better-recruiter-cultivating-better-relationships-with-hiring-managers/\" />\r\n\t\t\t<add key=\"/blog-articles/why-the-quality-of-your-vendor-relationship-could-determine-the-success-of-your-assessment-tool\" value=\"https://www.highmatch.com/blog/how-to-choose-a-pre-employment-test-vendor-relationships-matter/\" />\r\n\t\t\t<add key=\"/blog-articles/create-a-company-culture-that-attracts-the-best-people\" value=\"https://www.highmatch.com/blog/how-to-create-company-culture-that-attracts-the-best-people/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-engage-passive-candidates\" value=\"https://www.highmatch.com/blog/how-to-engage-passive-candidates/\" />\r\n\t\t\t<add key=\"/blog-articles/rapid-scaling-how-to-find-quality-candidates-quickly\" value=\"https://www.highmatch.com/blog/how-to-find-candidates-for-jobs-quickly-rapid-scaling/\" />\r\n\t\t\t<add key=\"/blog-articles/hiring-seasonal-staff\" value=\"https://www.highmatch.com/blog/how-to-find-eager-and-hard-working-temp-workers-for-your-busiest-time-of-the-year/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-hire-a-di-leader\" value=\"https://www.highmatch.com/blog/how-to-hire-a-diversity-and-inclusion-leader/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-find-great-employee-talent-when-demand-outstrips-supply\" value=\"https://www.highmatch.com/blog/how-to-hire-great-talent-when-demand-outstrips-supply/\" />\r\n\t\t\t<add key=\"/blog-articles/the-case-for-faster-more-efficient-hiring\" value=\"https://www.highmatch.com/blog/how-to-improve-recruiting-efficiency/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-increase-age-diversity-among-your-workforce\" value=\"https://www.highmatch.com/blog/how-to-increase-age-diversity-in-the-workplace/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-build-a-great-recruiting-video\" value=\"https://www.highmatch.com/blog/how-to-make-a-recruiting-video/\" />\r\n\t\t\t<add key=\"/blog-articles/how-do-you-measure-quality-of-hire\" value=\"https://www.highmatch.com/blog/how-to-measure-quality-of-hire/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-perform-a-job-analysis\" value=\"https://www.highmatch.com/blog/how-to-perform-a-job-analysis/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-recruit-top-talent-when-the-right-skills-don-t-exist\" value=\"https://www.highmatch.com/blog/how-to-perform-a-job-analysis/\" />\r\n\t\t\t<add key=\"/blog-articles/human-capital-analytics-3-steps-to-build-a-better-workforce\" value=\"https://www.highmatch.com/blog/human-capital-analytics-3-steps-to-build-a-better-workforce/\" />\r\n\t\t\t<add key=\"/blog-articles/6-steps-to-better-workforce-data\" value=\"https://www.highmatch.com/blog/human-capital-analytics-6-steps-to-better-workforce-data/\" />\r\n\t\t\t<add key=\"/blog-articles/ramp-up-on-boarding-with-pre-employment-testing-data\" value=\"https://www.highmatch.com/blog/improve-training-and-increase-employee-loyalty-with-pre-employment-assessment-test/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-get-job-requirements-right-and-improve-your-applicant-pool\" value=\"https://www.highmatch.com/blog/improve-your-applicant-pool-with-better-job-requirements/\" />\r\n\t\t\t<add key=\"/blog-articles/vetting-remote-workers-6-questions-to-ask\" value=\"https://www.highmatch.com/blog/looking-to-hire-remote-workers-6-questions-to-ask/\" />\r\n\t\t\t<add key=\"/blog-articles/where-to-compromise-when-making-hiring-decisions\" value=\"https://www.highmatch.com/blog/making-hiring-decisions-where-to-compromise/\" />\r\n\t\t\t<add key=\"/blog-articles/motivating-your-remote-workforce\" value=\"https://www.highmatch.com/blog/motivating-remote-workers/\" />\r\n\t\t\t<add key=\"/blog-articles/hiring-for-self-managing-teams\" value=\"https://www.highmatch.com/blog/organizational-agility-how-to-establish-self-managing-teams/\" />\r\n\t\t\t<add key=\"/blog-articles/overcoming-unconscious-bias\" value=\"https://www.highmatch.com/blog/overcoming-unconscious-bias-in-recruitment/\" />\r\n\t\t\t<add key=\"/blog-articles/uswnt-what-we-can-learn-from-their-success\" value=\"https://www.highmatch.com/blog/person-environment-fit-what-we-can-learn-from-uswnt/\" />\r\n\t\t\t<add key=\"/blog-articles/why-personality-testing-should-be-part-of-your-hiring-process\" value=\"https://www.highmatch.com/blog/personality-tests-for-hiring-why-you-should-use-them/\" />\r\n\t\t\t<add key=\"/blog-articles/personality-traits-that-predict-leadership-styles-on-virtual-teams\" value=\"https://www.highmatch.com/blog/personality-traits-and-leadership-styles-on-virtual-team/\" />\r\n\t\t\t<add key=\"/blog-articles/assessments-guide-both-external-and-internal-hiring\" value=\"https://www.highmatch.com/blog/pre-hire-assessment-tests-guide-external-and-internal-hiring/\" />\r\n\t\t\t<add key=\"/blog-articles/why-pre-employment-assessments-are-a-critical-part-of-entry-level-recruiting\" value=\"https://www.highmatch.com/blog/pre-employment-assessments-are-crucial-for-entry-level-recruiting/\" />\r\n\t\t\t<add key=\"/blog-articles/what-makes-a-great-pre-hire-test\" value=\"https://www.highmatch.com/blog/pre-hire-assessment-tests-what-makes-a-good-one/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-turn-assessment-skeptics-into-believers\" value=\"https://www.highmatch.com/blog/pre-hire-assessment-testing-turning-skeptics-into-believers/\" />\r\n\t\t\t<add key=\"/blog-articles/how-to-create-a-better-assessment-experience\" value=\"https://www.highmatch.com/blog/pre-hire-assessments-how-to-create-a-better-experience/\" />\r\n\t\t\t<add key=\"/blog-articles/pre-hire-tests-simplify-decisions\" value=\"https://www.highmatch.com/blog/pre-hire-testing-simplifies-decisions/\" />\r\n\t\t\t<add key=\"/blog-articles/pre-employment-assessments-can-create-positive-candidate-experiences\" value=\"https://www.highmatch.com/blog/pre-hire-tests-create-positive-candidate-experiences/\" />\r\n\t\t\t<add key=\"/blog-articles/generation-z-recruiting-what-you-need-to-know\" value=\"https://www.highmatch.com/blog/recruiting-gen-z-what-you-need-to-know/\" />\r\n\t\t\t<add key=\"/blog-articles/recruiting-in-a-pandemic-don-t-ignore-raw-talent\" value=\"https://www.highmatch.com/blog/recruiting-in-a-pandemic-dont-ignore-raw-talent/\" />\r\n\t\t\t<add key=\"/blog-articles/6-tips-to-attract-millennial-talent\" value=\"https://www.highmatch.com/blog/recruiting-millennials-in-the-workplace-6-tips/\" />\r\n\t\t\t<add key=\"/blog-articles/4-ways-to-improve-your-search-for-developers\" value=\"https://www.highmatch.com/blog/recruiting-software-developers-4-ways-to-improve/\" />\r\n\t\t\t<add key=\"/blog-articles/5-tips-for-filling-highly-specialized-roles\" value=\"https://www.highmatch.com/blog/recruiting-top-talent-5-tips-for-filling-highly-specialized-roles/\" />\r\n\t\t\t<add key=\"/blog-articles/3-ways-pre-employment-tests-support-recruiting-trends-for-2020\" value=\"https://www.highmatch.com/blog/recruiting-trends-for-2022-3-ways-pre-hire-tests-help/\" />\r\n\t\t\t<add key=\"/blog-articles/in-2020-this-is-how-recruiters-will-tackle-these-common-frustrations\" value=\"https://www.highmatch.com/blog/recruitment-challenges-2022-how-to-handle-them/\" />\r\n\t\t\t<add key=\"/blog-articles/remote-work-stories-during-the-quarantine\" value=\"https://www.highmatch.com/blog/remote-work-stories-from-the-quarantine/\" />\r\n\t\t\t<add key=\"/blog-articles/how-a-focus-on-reskilling-could-help-energy-companies-address-their-biggest-recruiting-challenge\" value=\"https://www.highmatch.com/blog/how-a-focus-on-reskilling-can-help-energy-companies-address-their-biggest-recruiting-challenge/\" />\r\n\t\t\t<add key=\"/blog-articles/6-reasons-resumes-don-t-work\" value=\"https://www.highmatch.com/blog/6-resume-facts-why-resumes-dont-work/\" />\r\n\t\t\t<add key=\"/blog-articles/are-you-hiring-self-taught-programmers-here-s-why-you-should\" value=\"https://www.highmatch.com/blog/should-you-hire-self-taught-programmers/\" />\r\n\t\t\t<add key=\"/blog-articles/skills-to-assess-when-hiring-remote-labor\" value=\"https://www.highmatch.com/blog/skills-to-assess-when-hiring-remote-workers/\" />\r\n\t\t\t<add key=\"/blog-articles/seeking-resilient-nurses-why-soft-skills-are-important-when-hiring-healthcare-workers\" value=\"https://www.highmatch.com/blog/soft-skills-for-nurses-whats-important-for-healthcare-hiring/\" />\r\n\t\t\t<add key=\"/blog-articles/building-a-stronger-workforce\" value=\"https://www.highmatch.com/blog/strategic-workforce-planning-building-a-stronger-workforce/\" />\r\n\t\t\t<add key=\"/blog-articles/the-2-types-of-costs-of-a-bad-hire\" value=\"https://www.highmatch.com/blog/the-cost-of-a-bad-hire-two-types-of-costs/\" />\r\n\t\t\t<add key=\"/blog-articles/the-future-of-recruiting\" value=\"https://www.highmatch.com/blog/the-future-of-recruiting/\" />\r\n\t\t\t<add key=\"/blog-articles/the-trouble-with-job-titles\" value=\"https://www.highmatch.com/blog/the-importance-of-soft-skills-and-the-trouble-with-job-titles/\" />\r\n\t\t\t<add key=\"/blog-articles/soft-skills-are-critical-when-hiring-skilled-labor\" value=\"https://www.highmatch.com/blog/the-importance-of-soft-skills-in-the-workplace/\" />\r\n\t\t\t<add key=\"/blog-articles/soft-skills-are-the-biggest-predictor-of-job-success-and-you-won-t-find-them-in-a-resume\" value=\"https://www.highmatch.com/blog/the-importance-of-soft-skills-you-wont-find-it-in-a-resume/\" />\r\n\t\t\t<add key=\"/blog-articles/employee-referrals-the-benefits-and-risks\" value=\"https://www.highmatch.com/blog/the-pros-and-cons-of-employee-referrals/\" />\r\n\t\t\t<add key=\"/blog-articles/the-science-of-culture-fit\" value=\"https://www.highmatch.com/blog/the-science-of-cultural-fit/\" />\r\n\t\t\t<add key=\"/blog-articles/the-secret-to-shortening-your-hiring-process\" value=\"https://www.highmatch.com/blog/the-secret-to-shortening-the-hiring-process/\" />\r\n\t\t\t<add key=\"/blog-articles/think-you-need-a-go-getter\" value=\"https://www.highmatch.com/blog/think-you-need-a-go-getter/\" />\r\n\t\t\t<add key=\"/blog-articles/gig-economy-five-tips-for-finding-and-vetting-employees\" value=\"https://www.highmatch.com/blog/gig-economy-five-tips-for-hiring-employees/\" />\r\n\t\t\t<add key=\"/blog-articles/attitude-and-aptitude-a-killer-combination\" value=\"https://www.highmatch.com/blog/use-personality-and-cognitive-aptitude-tests-for-better-entry-level-hires/\" />\r\n\t\t\t<add key=\"/blog-articles/how-can-an-assessment-support-your-interviews\" value=\"https://www.highmatch.com/blog/using-pre-interview-assessments-for-better-interviews/\" />\r\n\t\t\t<add key=\"/blog-articles/using-technology-to-recruit-talent\" value=\"https://www.highmatch.com/blog/using-technology-for-talent-recruiting/\" />\r\n\t\t\t<add key=\"/blog-articles/vetting-remote-workers\" value=\"https://www.highmatch.com/blog/vetting-remote-workers/\" />\r\n\t\t\t<add key=\"/blog-articles/what-does-hiring-for-culture-fit-mean\" value=\"https://www.highmatch.com/blog/ways-to-improve-your-hiring-process/\" />\r\n\t\t\t<add key=\"/blog-articles/utilizing-job-analysis-to-improve-hiring\" value=\"https://www.highmatch.com/blog/what-is-job-analysis-and-how-does-it-improve-hiring/\" />\r\n\t\t\t<add key=\"/blog-articles/how-the-8020-rule-applies-to-interviews\" value=\"https://www.highmatch.com/blog/what-is-the-80-20-rule-and-how-it-applies-to-interviews/\" />\r\n\t\t\t<add key=\"/blog-articles/what-the-supreme-court-s-lgbtq-ruling-means-for-your-business\" value=\"https://www.highmatch.com/blog/what-the-supreme-courts-lgbtq-ruling-means-for-you/\" />\r\n\t\t\t<add key=\"/blog-articles/what-to-know-if-your-workforce-is-suddenly-working-from-home\" value=\"https://www.highmatch.com/blog/what-to-know-if-your-workforce-is-suddenly-working-from-home/\" />\r\n\t\t\t<add key=\"/blog-articles/why-its-important-to-consider-person-environment-fit-when-hiring\" value=\"https://www.highmatch.com/blog/why-its-important-to-consider-person-environment-fit-when-hiring/\" />\r\n\t\t\t<add key=\"/blog-articles/why-resumes-once-valuable-calling-cards-are-obsolete\" value=\"https://www.highmatch.com/blog/why-resumes-are-obsolete/\" />\r\n\t\t\t<add key=\"/blog-articles/winning-the-c-suite-s-ear\" value=\"https://www.highmatch.com/blog/winning-the-ear-of-the-c-suite/\" />\r\n\t\t\t\r\n\t\t\t<add key=\"/assessment-copy\" value=\"https://www.highmatch.com/talent-insights/pre-employment-assessment-test/\" />\r\n\t\t\t<add key=\"/resources/how-to/connect-to-other-tools/using-icims\" value=\"https://www.highmatch.com/knowledge-base/using-your-icims-connector/\" />\r\n\t\t\t<add key=\"/resources/how-to/connect-to-other-tools/using-jobvite\" value=\"https://www.highmatch.com/knowledge-base/using-your-jobvite-connector/\" />\r\n\t\t\t<add key=\"/resources/how-to/connect-to-other-tools/using-lever\" value=\"https://www.highmatch.com/knowledge-base/using-your-lever-connector/\" />\r\n\t\t\t<add key=\"/resources/how-to/connect-to-other-tools/auto-assignment-rules\" value=\"https://www.highmatch.com/knowledge-base/creating-auto-assignment-rules/\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-job-type/call-centercustomer-service\" value=\"https://www.highmatch.com/solutions/customer-service-assessment-test/\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-job-type/software\" value=\"https://www.highmatch.com/solutions/software-hiring-assessment/\" />\r\n\t\t\t<add key=\"/solutions/skills-testing/tests-by-job-type/accountingfinance\" value=\"https://www.highmatch.com/solutions/finance-skills-assessment-test/\" />\r\n\t\t\t<add key=\"/features/hiring-profiles/sample-hiring-profile\" value=\"https://knowledge.highmatch.com/hubfs/PDFs/Sample%20Reports%20and%20Guides/HM-Sample%20Job%20Fit%20Report-Elizabeth%20Thompson.pdf\"/>\r\n\t\t\t\r\n\t\t\t<add key =\"/resources/how-to/connect-to-other-tools/cats-workflows\" value=\"https://www.highmatch.com/knowledge-base/using-cats-workflows-to-send-email-notifications-of-assessment-completions/\" />\r\n\t\t\t<add key =\"/resources/how-to/connect-to-other-tools/enabling-cats\" value=\"https://www.highmatch.com/knowledge-base/enabling-your-cats-connector/\" />\r\n\t\t\t<add key =\"/resources/how-to/connect-to-other-tools/using-taleo\" value=\"https://www.highmatch.com/knowledge-base/using-your-taleo-connector/\" />\r\n\t\t\t<add key =\"/resources/how-to/learn-the-basics/getting-started-with-berke\" value=\"https://www.highmatch.com/knowledge-base/getting-started-with-berke/\" />\r\n\t\t\t<add key =\"/resources/how-to/learn-the-basics/understanding-the-people-tab\" value=\"https://www.highmatch.com/knowledge-base/understanding-the-berke-people-tab/\" />\r\n\t\t\t<add key =\"/sales-success\" value=\"https://www.highmatch.com/talent-insights/sales-success/\" />\r\n\t\t\t<add key =\"/resources/how-to/learn-the-basics/understanding-reports\" value=\"https://www.highmatch.com/knowledge-base/understanding-your-reports/\" />\r\n\r\n        </rewriteMap>";

    private static async Task<Redirection> TestPath(string target, string to)
    {
        var handler = new HttpClientHandler
        {
            AllowAutoRedirect = true
        };

        using var httpClient = new HttpClient(handler);
        try
        {
            httpClient.BaseAddress = new Uri("http://www.berkeassessment.com");
            var response = await httpClient.GetAsync(target);
            var html = await response.Content.ReadAsStringAsync();
            var htmlDoc = new HtmlDocument();
            htmlDoc.LoadHtml(html);
            IEnumerable<HtmlNode> source = htmlDoc.DocumentNode.Descendants("title");
            var title = source?.FirstOrDefault()?.InnerText ?? "NO TITLE";
            
            var result = new Redirection
            {
                Code = response.StatusCode,
                From = target,
                To = to,
                Title = title,
                Size = html.Length
            };
            Console.WriteLine($"{result.Code} | {target}");
            return result;
        }
        catch (Exception e)
        {
            Console.WriteLine($"ERROR: {e.Message}");
            return new Redirection
                { Code = HttpStatusCode.RequestTimeout, From = target, To = to, Size = 0, Title = e.Message };
        }
    }
}